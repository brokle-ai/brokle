# Brokle Platform Environment Configuration

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
APP_NAME=Brokle
ENV=development
LOG_LEVEL=debug
PORT=8080

# =============================================================================
# DATABASE CONFIGURATION (Recommended: Use *_URL variables)
# =============================================================================

# PostgreSQL (Primary Database) - RECOMMENDED: Single URL approach
DATABASE_URL=postgres://brokle:brokle_password@localhost:5432/brokle_dev?sslmode=disable

# PostgreSQL Migration Settings
DATABASE_AUTO_MIGRATE=false
DATABASE_MIGRATIONS_PATH=./migrations/postgres

# PostgreSQL - ALTERNATIVE: Individual fields (for Docker/K8s/CI environments)
# POSTGRES_HOST=localhost
# POSTGRES_PORT=5432
# POSTGRES_USER=brokle
# POSTGRES_PASSWORD=brokle_password
# POSTGRES_DB=brokle_dev
# POSTGRES_SSL_MODE=disable

# ClickHouse (Analytics Database) - RECOMMENDED: Single URL approach
CLICKHOUSE_URL=clickhouse://brokle:brokle_password@localhost:9000/default

# ClickHouse Migration Settings
CLICKHOUSE_MIGRATIONS_PATH=./migrations/clickhouse
CLICKHOUSE_MIGRATIONS_TABLE=schema_migrations
CLICKHOUSE_MIGRATIONS_ENGINE=MergeTree

# ClickHouse - ALTERNATIVE: Individual fields (for Docker/K8s/CI environments)
# CLICKHOUSE_HOST=localhost
# CLICKHOUSE_PORT=8123
CLICKHOUSE_USER=brokle
# CLICKHOUSE_PASSWORD=brokle_password
# CLICKHOUSE_DB=default

# Redis (Cache & Sessions) - RECOMMENDED: Single URL approach
REDIS_URL=redis://localhost:6379/0

# Redis - ALTERNATIVE: Individual fields (for Docker/K8s/CI environments)
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0

# =============================================================================
# MESSAGE QUEUE
# =============================================================================
KAFKA_BROKERS=localhost:9092
KAFKA_CLIENT_ID=brokle-api
KAFKA_GROUP_ID=brokle-consumer-group

# =============================================================================
# AUTHENTICATION & SECURITY (New Smart JWT Configuration)
# =============================================================================

# Token Configuration (Go duration format: ns, us, ms, s, m, h)
ACCESS_TOKEN_TTL=15m
REFRESH_TOKEN_TTL=168h
TOKEN_ROTATION_ENABLED=true

# Rate Limiting Configuration
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_IP=100
RATE_LIMIT_PER_USER=1000
RATE_LIMIT_WINDOW=1h

# JWT Security - Flexible Method (HS256 for dev, RS256 for prod)
JWT_SIGNING_METHOD=HS256
JWT_ISSUER=brokle

# HS256 (Development/Simple deployments) - REQUIRED for HS256
JWT_SECRET=your-super-secret-jwt-key-at-least-32-chars-for-security

# RS256 (Production/Enterprise) - Use either file paths OR base64 keys
# JWT_PRIVATE_KEY_PATH=/path/to/jwt/private.pem
# JWT_PUBLIC_KEY_PATH=/path/to/jwt/public.pem
# JWT_PRIVATE_KEY_BASE64=<base64-encoded-private-key>
# JWT_PUBLIC_KEY_BASE64=<base64-encoded-public-key>

# JWT token TTL is now configured above as ACCESS_TOKEN_TTL and REFRESH_TOKEN_TTL
API_KEY_PREFIX=bk_
BCRYPT_COST=12

# Session configuration
SESSION_SECRET=your-session-secret-key-change-in-production
SESSION_TIMEOUT=7d

# CORS Configuration
# Comma-separated list, no spaces. Use "*" for all origins in development
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,https://yourdomain.com
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-API-Key

# =============================================================================
# STANDARD EXTERNAL API KEYS (No prefix required)
# =============================================================================
# AI Provider APIs - Standard naming convention
OPENAI_API_KEY=your-openai-api-key
ANTHROPIC_API_KEY=your-anthropic-api-key
COHERE_API_KEY=your-cohere-api-key

# Additional AI Providers (optional)
GOOGLE_AI_API_KEY=your-google-ai-api-key
HUGGINGFACE_API_KEY=your-huggingface-api-key
AZURE_OPENAI_API_KEY=your-azure-openai-key
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/

# Business & Billing APIs - Standard naming convention
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================
# Prometheus metrics
METRICS_ENABLED=true
METRICS_PORT=9100

# Grafana
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_SECRET_KEY=your-grafana-secret-key
GRAFANA_ROOT_URL=http://localhost:3001

# Alertmanager
ALERT_WEBHOOK_URL=
SLACK_WEBHOOK_URL=
EMAIL_ALERTS_ENABLED=false

# =============================================================================
# EMAIL CONFIGURATION
# =============================================================================
SMTP_HOST=localhost
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM_ADDRESS=noreply@brokle.com
SMTP_FROM_NAME=Brokle Platform

# =============================================================================
# FEATURE FLAGS
# =============================================================================
ENABLE_WEBSOCKETS=true
ENABLE_SEMANTIC_CACHING=true
ENABLE_REQUEST_LOGGING=true
ENABLE_COST_TRACKING=true
ENABLE_QUALITY_SCORING=true
ENABLE_AI_ROUTING=true

# =============================================================================
# CACHING CONFIGURATION
# =============================================================================
CACHE_TTL_DEFAULT=300
CACHE_TTL_SEMANTIC=3600
SEMANTIC_SIMILARITY_THRESHOLD=0.95
CACHE_MAX_SIZE=1000

# Rate limiting is configured in the AUTHENTICATION & SECURITY section above

# =============================================================================
# AI ROUTING CONFIGURATION
# =============================================================================
ROUTING_STRATEGY=performance
ROUTING_HEALTH_CHECK_INTERVAL=30s
ROUTING_TIMEOUT=30s
ROUTING_RETRY_ATTEMPTS=3

# =============================================================================
# COST TRACKING
# =============================================================================
COST_TRACKING_ENABLED=true
COST_ALERT_THRESHOLD=100.00
MONTHLY_BUDGET_LIMIT=1000.00

# =============================================================================
# FRONTEND CONFIGURATION
# =============================================================================
NEXT_PUBLIC_API_URL=http://localhost:8080
NEXT_PUBLIC_WS_URL=ws://localhost:8080
NEXT_PUBLIC_APP_URL=http://localhost:3000

# =============================================================================
# DEVELOPMENT & TESTING
# =============================================================================
DEBUG_ENABLED=true
TEST_DATABASE_URL=postgres://brokle_test:brokle_test_password@localhost:5433/brokle_test?sslmode=disable

# =============================================================================
# BROKLE-SPECIFIC CONFIGURATION (Use BROKLE_ prefix)
# =============================================================================
# SDK Client Configuration (for applications using Brokle SDKs)
# BROKLE_API_KEY=ak_your_api_key_here
# BROKLE_HOST=http://localhost:8000
# BROKLE_PROJECT_ID=proj_your_project_id
# BROKLE_ENVIRONMENT=production

# Enterprise Features (Only for Business/Enterprise licenses)
# BROKLE_ENTERPRISE_LICENSE_KEY=your-license-key
# BROKLE_ENTERPRISE_LICENSE_TYPE=business
# BROKLE_ENTERPRISE_SSO_ENABLED=true
# BROKLE_ENTERPRISE_SSO_PROVIDER=saml
# BROKLE_ENTERPRISE_RBAC_ENABLED=true
# BROKLE_ENTERPRISE_COMPLIANCE_ENABLED=true
# BROKLE_ENTERPRISE_ANALYTICS_ENABLED=true

# =============================================================================
# PRODUCTION OVERRIDES (Uncomment for production)
# =============================================================================
# ENV=production
# LOG_LEVEL=info
# DEBUG_ENABLED=false
# DATABASE_URL=postgres://user:password@prod-host:5432/brokle_prod?sslmode=require
# CORS_ALLOWED_ORIGINS=https://yourdomain.com
# JWT_SECRET=your-super-secure-production-jwt-secret
# SESSION_SECRET=your-super-secure-production-session-secret
# STRIPE_SECRET_KEY=sk_live_your-live-stripe-key

# Blob Storage Configuration (S3/MinIO)
# Note: LLM input/output data is stored directly in ClickHouse with ZSTD compression for optimal cost and performance.
# Blob storage is available for future features: scheduled exports, media files, raw event storage, etc.
BLOB_STORAGE_PROVIDER=minio
BLOB_STORAGE_BUCKET_NAME=brokle
BLOB_STORAGE_REGION=us-east-1
BLOB_STORAGE_ENDPOINT=http://localhost:9100
BLOB_STORAGE_ACCESS_KEY_ID=minioadmin
BLOB_STORAGE_SECRET_ACCESS_KEY=minioadmin
BLOB_STORAGE_USE_PATH_STYLE=true
# BLOB_STORAGE_THRESHOLD is deprecated (no longer used for auto-offload)
BLOB_STORAGE_THRESHOLD=10000
